<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>z - Advanced topic: Understanding the rPackages set release cycle and using bleeding edge packages • rix</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="z - Advanced topic: Understanding the rPackages set release cycle and using bleeding edge packages">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rix</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a-getting-started.html">a - Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/b1-setting-up-and-using-rix-on-linux-and-windows.html">b1 - Setting up and using rix on Linux and Windows</a></li>
    <li><a class="dropdown-item" href="../articles/b2-setting-up-and-using-rix-on-macos.html">b2 - Setting up and using rix on macOS</a></li>
    <li><a class="dropdown-item" href="../articles/c-using-rix-to-build-project-specific-environments.html">c - Using rix to build project specific environments</a></li>
    <li><a class="dropdown-item" href="../articles/d1-installing-r-packages-in-a-nix-environment.html">d1 - Installing R packages in a Nix environment</a></li>
    <li><a class="dropdown-item" href="../articles/d2-installing-system-tools-and-texlive-packages-in-a-nix-environment.html">d2 - Installing system tools and TexLive packages in a Nix environment</a></li>
    <li><a class="dropdown-item" href="../articles/e-interactive-use.html">e - Interactive use</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-building-an-environment-for-literate-programming.html">z - Advanced topic: Building an environment for literate programming</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-handling-packages-with-remote-dependencies.html">z - Advanced topic: Handling packages with remote dependencies</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-reproducible-analytical-pipelines-with-nix.html">z - Advanced topic: Reproducible Analytical Pipelines with Nix</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-running-r-or-shell-code-in-nix-from-r.html">z - Advanced topic: Running R or Shell Code in Nix from R</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-using-nix-inside-docker.html">z - Advanced topic: Using Nix inside Docker</a></li>
    <li><a class="dropdown-item" href="../articles/z-binary_cache.html">z - Advanced topic: Rolling out your own binary cache</a></li>
    <li><a class="dropdown-item" href="../articles/z-bleeding_edge.html">z - Advanced topic: Understanding the rPackages set release cycle and using bleeding edge packages</a></li>
    <li><a class="dropdown-item" href="../articles/z-contributing_to_nixpkgs.html">z - Advanced topic: Contributing to nixpkgs</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/b-rodrigues/rix/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>z - Advanced topic: Understanding the rPackages set release cycle and using bleeding edge packages</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/b-rodrigues/rix/blob/master/vignettes/z-bleeding_edge.Rmd" class="external-link"><code>vignettes/z-bleeding_edge.Rmd</code></a></small>
      <div class="d-none name"><code>z-bleeding_edge.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>It is important to understand the release cycle of the rPackages set
and what steps you should take if you need bleeding edge packages. R
packages on <code>nixpkgs</code> tend to get updated alongside a new
release of R, and the reason is to ensure a certain level of quality.
The vast majority of CRAN (and Bioconductor) packages are made available
through <code>nixpkgs</code> in a fully automated way. But some packages
do require some manual intervention to work on Nix, and we only know
this if we try to build these packages, but building packages requires
quite a lot of resources. We can’t build CRAN packages every single day
to see if everything works well on Nix, so we only rebuild the whole
tree whenever there’s a new release of R. Packages get built on a CI
infrastructure called <em>Hydra</em>, and then these packages get cached
on <a href="https://cache.nixos.org/" class="external-link">cache.nixos.org</a> so whenever
someone wants to install a package, a pre-built binary gets download
from the cache. This avoids having to build software from source
locally. For packages that don’t need compiling this is not that big of
a time save, but for packages that do need to get compiled it is huge.
Depending on which packages you want to install, if you had to build
everything from source, it could potentially take hours, but if you can
install pre-built binaries it’s just a matter of how quick your internet
connection is.</p>
</div>
<div class="section level2">
<h2 id="r-packages-available-through-nix">R packages available through Nix<a class="anchor" aria-label="anchor" href="#r-packages-available-through-nix"></a>
</h2>
<p>As explained in the introduction, the <em>rPackages</em> set on
<code>nixpkgs</code> gets updated shortly after a new release of R. The
process involves first updating the package definitions found <a href="https://github.com/NixOS/nixpkgs/blob/nixos-unstable/pkgs/development/r-modules/" class="external-link">here</a>,
and then building the whole tree on a CI platform called <em>Hydra</em>.
Build failures then get fixed by volunteers (to learn how you can
contribute, read the
<code><a href="../articles/z-contributing_to_nixpkgs.html">vignette("z-contributing_to_nixpkgs")</a></code>). After the most
important packages have been fixed, the whole rPackages set gets updated
and made available through <code>nixpkgs</code> master branch.</p>
<p>Essentially this means that if you start a project with
<a href="https://b-rodrigues.github.io/rix/">rix</a> using <code>"latest"</code> as the <code>r_ver</code>
just after the rPackages set got updated, this project will use very
fresh packages. But if instead you start a project just before an R
release, then the environment will be using older packages. In practice
this rarely matters, unless you absolutely need a very recent version of
a specific package because you need a specific feature, or if you need
an environment with bleeding edge packages for development. For cases
like this, we provide the <code>r_ver = "bleeding_edge"</code> and
<code>r_ver = "frozen_edge"</code> options that makes it possible to use
the most recent packages for your environment, but at a cost. You must
be aware of this cost which we detail in the next section.</p>
</div>
<div class="section level2">
<h2 id="using-bleeding-and-frozen-edge-package-for-your-environments">Using bleeding and frozen edge package for your environments<a class="anchor" aria-label="anchor" href="#using-bleeding-and-frozen-edge-package-for-your-environments"></a>
</h2>
<p>CRAN is continuously getting new or updated packages. When you use R
outside of Nix, running <code>install.packages(pkg)</code> will install
the latest version of the <code>{pkg}</code> package available from CRAN
(unless you changed the default repository url). With Nix, packages do
not get downloaded from CRAN but for the <code>nixpkgs</code> repository
and they may be outdated as explained above. If you require bleeding
edge packages, use the <code>"bleeding_edge"</code> option to
<code>r_ver</code>. This will <strong>NOT</strong> download packages
from the official <code>nixpkgs</code> repository anymore, but from a
fork that we maintain that you can find <a href="https://github.com/rstats-on-nix/nixpkgs/tree/r-daily" class="external-link">here</a>.
This fork gets updated every 12 hours with the latest commits from both
the <code>nixpkgs</code> repository and CRAN. This means that
environments generated using this fork will contain bleeding packages
for both the CRAN (and Bioconductor) packages as well as system-level
dependencies. Also, be aware that this will generate an expression that
is <strong>NOT</strong> reproducible! Each time you will rebuild the
environment generated using the <code>"bleeding_edge"</code> option, you
will get exactly that: an environment with bleeding edge packages at
build time. If you want instead to have bleeding edge packages at the
time you generate the expression, but then want reproducibility (in
other words, building should always result in the same environment),
then use the <code>"frozen_edge"</code> option instead.</p>
<p>In any case, whatever option you choose, using them comes at a cost
of which you must be aware.</p>
<p>First, because these packages are bleeding edge, they have not had
the chance to be built by <em>Hydra</em> yet. <em>Hydra</em>
periodically builds packages and these get cached. So if you’re using
Nix, pre-compiled binaries get used instead of being built from source.
This is not the case if you use our fork, <strong>unless</strong> you
also use the cache that we provide, courtesy of <a href="https://app.cachix.org/cache/rstats-on-nix#pull" class="external-link">cachix.org</a>.
Cachix provides a cache for your own projects and works seamlessly with
the official Nix cache. However, we are limited in space, and cannot
possible cache all the CRAN packages. So only the most popular packages
get built and cached, and hopefully the packages you need are part of
this limited set. To use the cache, run the following commands on your
computer. First, install the Cachix client:</p>
<pre><code>nix-env -iA cachix -f https://cachix.org/api/v1/install</code></pre>
<p>then use the cache:</p>
<pre><code>cachix use rstats-on-nix</code></pre>
<p>that’s it! Packages now not only will get pulled from the official
cache, but also from the dedicated <code>rstats-on-nix</code> cache. Our
cache also contains the latest version of R, which sometimes can also
lag behind on the official <code>nixpkgs</code> repository.</p>
</div>
<div class="section level2">
<h2 id="making-your-own-cache">Making your own cache<a class="anchor" aria-label="anchor" href="#making-your-own-cache"></a>
</h2>
<p>If you need packages that are not included in the
<code>rstats-on-nix</code> cache, you can very easily roll out your own
binary cache. Simply build the environment once on one machine, and then
push the binaries in a cache for re-use. Refer to the vignette
<code><a href="../articles/z-binary_cache.html">vignette("z-binary_cache")</a></code> to learn how to set up your own
cache.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bruno Rodrigues, Philipp Baumann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
