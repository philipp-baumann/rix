<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate a Nix expression that builds a reproducible development environment — rix • rix</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate a Nix expression that builds a reproducible development environment — rix"><meta name="description" content="Generate a Nix expression that builds a reproducible development environment"><meta property="og:description" content="Generate a Nix expression that builds a reproducible development environment"><meta property="og:image" content="https://b-rodrigues.github.io/rix/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rix</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a-getting-started.html">a - Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/b1-setting-up-and-using-rix-on-linux-and-windows.html">b1 - Setting up and using rix on Linux and Windows</a></li>
    <li><a class="dropdown-item" href="../articles/b2-setting-up-and-using-rix-on-macos.html">b2 - Setting up and using rix on macOS</a></li>
    <li><a class="dropdown-item" href="../articles/c-using-rix-to-build-project-specific-environments.html">c - Using rix to build project specific environments</a></li>
    <li><a class="dropdown-item" href="../articles/d1-installing-r-packages-in-a-nix-environment.html">d1 - Installing R packages in a Nix environment</a></li>
    <li><a class="dropdown-item" href="../articles/d2-installing-system-tools-and-texlive-packages-in-a-nix-environment.html">d2 - Installing system tools and TexLive packages in a Nix environment</a></li>
    <li><a class="dropdown-item" href="../articles/e-interactive-use.html">e - Interactive use</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-building-an-environment-for-literate-programming.html">z - Advanced topic: Building an environment for literate programming</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-handling-packages-with-remote-dependencies.html">z - Advanced topic: Handling packages with remote dependencies</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-reproducible-analytical-pipelines-with-nix.html">z - Advanced topic: Reproducible Analytical Pipelines with Nix</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-running-r-or-shell-code-in-nix-from-r.html">z - Advanced topic: Running R or Shell Code in Nix from R</a></li>
    <li><a class="dropdown-item" href="../articles/z-advanced-topic-using-nix-inside-docker.html">z - Advanced topic: Using Nix inside Docker</a></li>
    <li><a class="dropdown-item" href="../articles/z-binary_cache.html">z - Advanced topic: Rolling out your own binary cache</a></li>
    <li><a class="dropdown-item" href="../articles/z-bleeding_edge.html">z - Advanced topic: Understanding the rPackages set release cycle and using bleeding edge packages</a></li>
    <li><a class="dropdown-item" href="../articles/z-contributing_to_nixpkgs.html">z - Advanced topic: Contributing to nixpkgs</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/b-rodrigues/rix/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate a Nix expression that builds a reproducible development environment</h1>
      <small class="dont-index">Source: <a href="https://github.com/b-rodrigues/rix/blob/master/R/rix.R" class="external-link"><code>R/rix.R</code></a></small>
      <div class="d-none name"><code>rix.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generate a Nix expression that builds a reproducible development environment</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rix</span><span class="op">(</span></span>
<span>  r_ver <span class="op">=</span> <span class="st">"latest"</span>,</span>
<span>  r_pkgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  system_pkgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  git_pkgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  local_r_pkgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tex_pkgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ide <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"other"</span>, <span class="st">"code"</span>, <span class="st">"radian"</span>, <span class="st">"rstudio"</span>, <span class="st">"rserver"</span><span class="op">)</span>,</span>
<span>  project_path <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  print <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  message_type <span class="op">=</span> <span class="st">"simple"</span>,</span>
<span>  shell_hook <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-r-ver">r_ver<a class="anchor" aria-label="anchor" href="#arg-r-ver"></a></dt>
<dd><p>Character, defaults to "latest". The required R version, for
example "4.0.0". You can check which R versions are available using
<code><a href="available_r.html">available_r()</a></code>. For reproducibility purposes, you can also provide a
<code>nixpkgs</code> revision directly. For older versions of R, <code>nix-build</code> might
fail with an error stating 'this derivation is not meant to be built'. In
this case, simply drop into the shell with <code>nix-shell</code> instead of building
it first. It is also possible to provide either "bleeding_edge" or
"frozen_edge" if you need an environment with bleeding edge packages. Read
more in the "Details" section below.</p></dd>


<dt id="arg-r-pkgs">r_pkgs<a class="anchor" aria-label="anchor" href="#arg-r-pkgs"></a></dt>
<dd><p>Vector of characters. List the required R packages for your
analysis here.</p></dd>


<dt id="arg-system-pkgs">system_pkgs<a class="anchor" aria-label="anchor" href="#arg-system-pkgs"></a></dt>
<dd><p>Vector of characters. List further software you wish to
install that are not R packages such as command line applications for
example. You can look for available software on the NixOS website
<a href="https://search.nixos.org/packages?channel=unstable&amp;from=0&amp;size=50&amp;sort=relevance&amp;type=packages&amp;query=" class="external-link">https://search.nixos.org/packages?channel=unstable&amp;from=0&amp;size=50&amp;sort=relevance&amp;type=packages&amp;query=</a></p></dd>


<dt id="arg-git-pkgs">git_pkgs<a class="anchor" aria-label="anchor" href="#arg-git-pkgs"></a></dt>
<dd><p>List. A list of packages to install from Git. See details for
more information.</p></dd>


<dt id="arg-local-r-pkgs">local_r_pkgs<a class="anchor" aria-label="anchor" href="#arg-local-r-pkgs"></a></dt>
<dd><p>List. A list of local packages to install. These packages
need to be in the <code>.tar.gz</code> or <code>.zip</code> formats and must be in the same
folder as the generated "default.nix" file.</p></dd>


<dt id="arg-tex-pkgs">tex_pkgs<a class="anchor" aria-label="anchor" href="#arg-tex-pkgs"></a></dt>
<dd><p>Vector of characters. A set of TeX packages to install. Use
this if you need to compile <code>.tex</code> documents, or build PDF documents using
Quarto. If you don't know which package to add, start by adding "amsmath".
See the Vignette "Authoring LaTeX documents" for more details.</p></dd>


<dt id="arg-ide">ide<a class="anchor" aria-label="anchor" href="#arg-ide"></a></dt>
<dd><p>Character, defaults to "other". If you wish to use RStudio to work
interactively use "rstudio" or "rserver" for the server version. Use "code"
for Visual Studio Code. You can also use "radian", an interactive REPL. For
other editors, use "other". This has been tested with RStudio, VS Code and
Emacs. If other editors don't work, please open an issue.</p></dd>


<dt id="arg-project-path">project_path<a class="anchor" aria-label="anchor" href="#arg-project-path"></a></dt>
<dd><p>Character, defaults to the current working directory.
Where to write <code>default.nix</code>, for example "/home/path/to/project". The file
will thus be written to the file "/home/path/to/project/default.nix". If
the folder does not exist, it will be created.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Logical, defaults to FALSE. If TRUE, overwrite the
<code>default.nix</code> file in the specified path.</p></dd>


<dt id="arg-print">print<a class="anchor" aria-label="anchor" href="#arg-print"></a></dt>
<dd><p>Logical, defaults to FALSE. If TRUE, print <code>default.nix</code> to
console.</p></dd>


<dt id="arg-message-type">message_type<a class="anchor" aria-label="anchor" href="#arg-message-type"></a></dt>
<dd><p>Character. Message type, defaults to <code>"simple"</code>, which
gives minimal but sufficient feedback. Other values are currently
<code>"quiet</code>, which generates the files without message, and <code>"verbose"</code>,
displays all the messages.</p></dd>


<dt id="arg-shell-hook">shell_hook<a class="anchor" aria-label="anchor" href="#arg-shell-hook"></a></dt>
<dd><p>Character of length 1, defaults to <code>NULL</code>. Commands added
to the <code>shellHook</code> variable are executed when the Nix shell starts. So by
default, using <code>nix-shell default.nix</code> will start a specific program,
possibly with flags (separated by space), and/or do shell actions. You can
for example use <code>shell_hook = R</code>, if you want to directly enter the
declared Nix R session when dropping into the Nix shell.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Nothing, this function only has the side-effect of writing two files:
<code>default.nix</code> and <code>.Rprofile</code> in the working directory. <code>default.nix</code>
contains a Nix expression to build a reproducible environment using the Nix
package manager, and <code>.Rprofile</code> ensures that a running R session from a
Nix environment cannot access local libraries, nor install packages using
<code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function will write a <code>default.nix</code> and an <code>.Rprofile</code> in the
chosen path. Using the Nix package manager, it is then possible to build a
reproducible development environment using the <code>nix-build</code> command in the
path. This environment will contain the chosen version of R and packages,
and will not interfere with any other installed version (via Nix or not) on
your machine. Every dependency, including both R package dependencies but
also system dependencies like compilers will get installed as well in that
environment.</p>
<p>It is possible to use environments built with Nix interactively, either
from the terminal, or using an interface such as RStudio. If you want to
use RStudio, set the <code>ide</code> argument to <code>"rstudio"</code>. Please be aware that
RStudio is not available for macOS through Nix. As such, you may want to
use another editor on macOS. To use Visual Studio Code (or Codium), set the
<code>ide</code> argument to <code>"code"</code>, which will add the <code>{languageserver}</code> R package
to the list of R packages to be installed by Nix in that environment. You
can use the version of Visual Studio Code or Codium you already use, or
also install it using Nix (by adding "vscode" or "vscodium" to the list of
<code>system_pkgs</code>). For non-interactive use, or to use the environment from the
command line, or from another editor (such as Emacs or Vim), set the <code>ide</code>
argument to <code>"other"</code>. We recommend reading the
<code><a href="../articles/e-interactive-use.html">vignette("e-interactive-use")</a></code> for more details.</p>
<p>Packages to install from Github must be provided in a list of 4 elements:
"package_name", "repo_url" and "commit". This argument can
also be a list of lists of these 3 elements. It is also possible to install
old versions of packages by specifying a version. For example, to install
the latest version of <code>{AER}</code> but an old version of <code>{ggplot2}</code>, you could
write: <code>r_pkgs = c("AER", "ggplot2@2.2.1")</code>. Note however that doing this
could result in dependency hell, because an older version of a package
might need older versions of its dependencies, but other packages might
need more recent versions of the same dependencies. If instead you want to
use an environment as it would have looked at the time of <code>{ggplot2}</code>'s
version 2.2.1 release, then use the Nix revision closest to that date, by
setting <code>r_ver = "3.1.0"</code>, which was the version of R current at the time.
This ensures that Nix builds a completely coherent environment.</p>
<p>Note that installing packages from Git or old versions using the <code>"@"</code>
notation or local packages, does not leverage Nix's capabilities for
dependency solving. As such, you might have trouble installing these
packages. If that is the case, open an issue on <code>{rix}</code>'s Github
repository.</p>
<p>By default, the Nix shell will be configured with <code>"en_US.UTF-8"</code> for the
relevant locale variables (<code>LANG</code>, <code>LC_ALL</code>, <code>LC_TIME</code>, <code>LC_MONETARY</code>,
<code>LC_PAPER</code>, <code>LC_MEASUREMENT</code>). This is done to ensure locale
reproducibility by default in Nix environments created with <code>rix()</code>. If
there are good reasons to not stick to the default, you can set your
preferred locale variables via <code>options(rix.nix_locale_variables = list(LANG = "de_CH.UTF-8", &lt;...&gt;)</code> and the aforementioned locale variable
names.</p>
<p>It is possible to use <code>"bleeding_edge</code>" or <code>"frozen_edge</code>" as the value for
the <code>r_ver</code> argument. This will create an environment with the very latest
R packages. <code>"bleeding_edge</code>" means that every time you will build the
environment, the packages will get updated. This is especially useful for
environments that need to be constantly updated, for example when
developing a package. In contrast, <code>"frozen_edge</code>" will create an
environment that will remain stable at build time. So if you create a
<code>default.nix</code> file using <code>"bleeding_edge</code>", each time you build it using
<code>nix-build</code> that environment will be up-to-date. With <code>"frozen_edge</code>" that
environment will be up-to-date on the date that the <code>default.nix</code> will be
generated, and then each subsequent call to <code>nix-build</code> will result in the
same environment. We highly recommend you read the vignette titled
"z - Advanced topic: Understanding the rPackages set release cycle and using bleeding edge packages".</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>

    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bruno Rodrigues, Philipp Baumann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

